"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[320],{7320:function(e,t,r){r.r(t),r.d(t,{default:function(){return components_TranscriptionApp}});var a=r(7437),s=r(2265),n=r(1541),l=r(6264),i=r(3101),o=r(4900),c=r(6224),d=r(5817),u=r(6061),p=r(7042),m=r(3986);function cn(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,m.m)((0,p.W)(t))}let f=(0,u.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),x=s.forwardRef((e,t)=>{let{className:r,variant:s,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:cn(f({variant:s}),r),...n})});x.displayName="Alert";let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h5",{ref:t,className:cn("mb-1 font-medium leading-none tracking-tight",r),...s})});h.displayName="AlertTitle";let g=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:cn("text-sm [&_p]:leading-relaxed",r),...s})});g.displayName="AlertDescription";var v=r(4972);let y=(0,u.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),b=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:l=!1,...i}=e,o=l?v.g7:"button";return(0,a.jsx)(o,{className:cn(y({variant:s,size:n,className:r})),ref:t,...i})});b.displayName="Button";let j=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:cn("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});j.displayName="Card";let N=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:cn("flex flex-col space-y-1.5 p-6",r),...s})});N.displayName="CardHeader";let w=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:cn("text-2xl font-semibold leading-none tracking-tight",r),...s})});w.displayName="CardTitle";let k=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:cn("text-sm text-muted-foreground",r),...s})});k.displayName="CardDescription";let A=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:cn("p-6 pt-0",r),...s})});A.displayName="CardContent";let S=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:cn("flex items-center p-6 pt-0",r),...s})});S.displayName="CardFooter";let C=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:cn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});C.displayName="Input";var T=r(3607);let R=s.forwardRef((e,t)=>{let{className:r,orientation:s="horizontal",decorative:n=!0,...l}=e;return(0,a.jsx)(T.f,{ref:t,decorative:n,orientation:s,className:cn("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",r),...l})});R.displayName=T.f.displayName;var E=r(485);let P=s.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(E.fC,{ref:t,className:cn("relative overflow-hidden",r),...n,children:[(0,a.jsx)(E.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,a.jsx)(_,{}),(0,a.jsx)(E.Ns,{})]})});P.displayName=E.fC.displayName;let _=s.forwardRef((e,t)=>{let{className:r,orientation:s="vertical",...n}=e;return(0,a.jsx)(E.gb,{ref:t,orientation:s,className:cn("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...n,children:(0,a.jsx)(E.q4,{className:"relative flex-1 rounded-full bg-border"})})});_.displayName=E.gb.displayName;var components_TranscriptionApp=()=>{let[e,t]=(0,s.useState)(()=>localStorage.getItem("assemblyai_key")||""),[r,u]=(0,s.useState)(null),[p,m]=(0,s.useState)(!1),[f,h]=(0,s.useState)(null),[v,y]=(0,s.useState)(null),[S,T]=(0,s.useState)({}),[E,_]=(0,s.useState)({}),[I,U]=(0,s.useState)(!1),[z,L]=(0,s.useState)(null),O=(0,s.useRef)(null),Z=(0,s.useRef)(null),F=(0,s.useRef)(null);(0,s.useEffect)(()=>(Z.current=new Audio,()=>{Z.current&&(Z.current.pause(),Z.current.src="")}),[]);let uploadToAssemblyAI=async t=>{if(!e)throw Error("Please enter your AssemblyAI API key");try{let r=await fetch("https://api.assemblyai.com/v2/upload",{method:"POST",headers:{Authorization:e},body:t});if(!r.ok)throw Error("Failed to upload audio file");let a=await r.json(),s=a.upload_url,n=await fetch("https://api.assemblyai.com/v2/transcript",{method:"POST",headers:{Authorization:e,"Content-Type":"application/json"},body:JSON.stringify({audio_url:s,speaker_labels:!0})});if(!n.ok)throw Error("Failed to initiate transcription");let l=await n.json(),i=await pollTranscriptionStatus(l.id);return i}catch(e){throw Error("Transcription failed: ".concat(e instanceof Error?e.message:"Unknown error"))}},pollTranscriptionStatus=async t=>{if(!e)throw Error("Please enter your AssemblyAI API key");let r=0;for(;r<120;){let a=await fetch("https://api.assemblyai.com/v2/transcript/".concat(t),{headers:{Authorization:e}}),s=await a.json();if("completed"===s.status)return s;if("error"===s.status)throw Error("Transcription failed");r++,await new Promise(e=>setTimeout(e,1e3))}throw Error("Transcription timed out")},findSpeakerExcerpts=e=>{let t={};e.forEach(e=>{t[e.speaker]||(t[e.speaker]=[]),t[e.speaker].push(e)});let r={};return Object.keys(t).forEach(e=>{let a=t[e],s=[...a].sort((e,t)=>t.end-t.start-(e.end-e.start));r[e]=s.slice(0,3)}),r},handleSubmit=async()=>{if(r){m(!0),h(null);try{let e=await uploadToAssemblyAI(r);y(e);let t=Array.from(new Set(e.utterances.map(e=>e.speaker))),a={};t.forEach(e=>{a[e]=""}),T(a);let s=findSpeakerExcerpts(e.utterances);_(s)}catch(e){h(e instanceof Error?e.message:"Error processing the audio file"),console.error(e)}finally{m(!1)}}},handleSpeakerNameChange=(e,t)=>{T(r=>({...r,[e]:t}))},formatTimestamp=e=>{let t=Math.floor(e/1e3),pad=e=>e.toString().padStart(2,"0");return"".concat(pad(Math.floor(t/3600)),":").concat(pad(Math.floor(t%3600/60)),":").concat(pad(t%60))},stopCurrentPlayback=()=>{Z.current&&(Z.current.pause(),F.current&&(Z.current.removeEventListener("timeupdate",F.current),F.current=null),Z.current.src=""),U(!1),L(null)},playAudioExcerpt=async(e,t)=>{if(r&&Z.current)try{if(stopCurrentPlayback(),z==="".concat(e,"-").concat(t))return;let a=new Blob([r],{type:r.type}),s=URL.createObjectURL(a);Z.current.src=s,Z.current.currentTime=e/1e3;let handleTimeUpdate=()=>{Z.current&&Z.current.currentTime>=t/1e3&&(stopCurrentPlayback(),URL.revokeObjectURL(s))};F.current=handleTimeUpdate,Z.current.addEventListener("timeupdate",handleTimeUpdate),await Z.current.play(),U(!0),L("".concat(e,"-").concat(t))}catch(e){console.error("Audio playback error:",e),stopCurrentPlayback()}};return(0,a.jsxs)("div",{className:"container max-w-4xl mx-auto p-4 space-y-8",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:"VoiceScribe AI"}),(0,a.jsx)("p",{className:"text-muted-foreground text-lg",style:{fontStyle:"italic"},children:"Recordings to text with speaker recognition. Powered by AssemblyAI."})]}),!e&&(0,a.jsxs)(j,{children:[(0,a.jsxs)(N,{children:[(0,a.jsx)(w,{children:"API Key Required"}),(0,a.jsxs)(k,{children:["Get your free API key from"," ",(0,a.jsx)("a",{href:"https://www.assemblyai.com/",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"AssemblyAI"})]})]}),(0,a.jsx)(A,{children:(0,a.jsx)(C,{type:"text",placeholder:"Enter your AssemblyAI API key",value:e,onChange:e=>{t(e.target.value),localStorage.setItem("assemblyai_key",e.target.value)}})})]}),(0,a.jsx)(j,{children:(0,a.jsxs)(A,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},className:"flex items-center gap-9 cursor-pointer hover:bg-gray-50 p-3 rounded-lg transition-colors",children:[(0,a.jsx)(n.Z,{className:"h-5 w-5 text-muted-foreground shrink-0"}),(0,a.jsx)("span",{className:"text-muted-foreground truncate max-w-[500px]",children:r?r.name:"Upload your audio file"})]}),r&&!v&&(0,a.jsx)(b,{onClick:handleSubmit,disabled:p,children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Transcribe"})]}),(0,a.jsx)("input",{ref:O,type:"file",onChange:e=>{var t;let r=e.target,a=null===(t=r.files)||void 0===t?void 0:t[0];r.value="",a&&a.type.startsWith("audio/")?(Z.current&&(Z.current.pause(),Z.current.src=""),U(!1),L(null),u(a),h(null),y(null),T({}),_({})):a&&(h("Please upload a valid audio file"),u(null))},accept:"audio/*",className:"hidden",style:{display:"none"}})]})}),f&&(0,a.jsx)(x,{variant:"destructive",children:(0,a.jsx)(g,{children:f})}),v&&(0,a.jsxs)("div",{className:"grid gap-8 md:grid-cols-2",children:[(0,a.jsxs)(j,{className:"mt-8",children:[(0,a.jsx)(N,{className:"pb-2",children:(0,a.jsx)(w,{className:"!font-bold text-2xl mb-6",style:{fontWeight:700},children:"Speakers"})})," ",(0,a.jsx)(A,{className:"space-y-6",children:Object.keys(S).map(e=>{var t;return(0,a.jsxs)("div",{className:"space-y-6",children:[" ",(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("span",{className:"min-w-[100px] text-sm text-muted-foreground italic",children:["Speaker ",e]}),(0,a.jsx)(C,{value:S[e],onChange:t=>handleSpeakerNameChange(e,t.target.value),placeholder:"enter name ".concat(e),className:"italic placeholder:italic"})]}),(0,a.jsx)("div",{className:"space-y-3 pl-4",children:null===(t=E[e])||void 0===t?void 0:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[" ",(0,a.jsx)(b,{size:"icon",variant:"ghost",onClick:()=>playAudioExcerpt(e.start,e.end),className:"h-8 w-8",children:z==="".concat(e.start,"-").concat(e.end)&&I?(0,a.jsx)(i.Z,{className:"h-4 w-4"}):(0,a.jsx)(o.Z,{className:"h-4 w-4"})}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:formatTimestamp(e.start)})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm line-clamp-2",children:e.text})," "]})]},t))}),(0,a.jsx)(R,{className:"my-4"})]},e)})})]}),(0,a.jsxs)(j,{className:"mt-8",children:[(0,a.jsxs)(N,{className:"flex-row items-center justify-between pb-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)(w,{className:"!font-bold text-2xl mb-6",style:{fontWeight:700},children:"Transcript"})})," ",(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(b,{size:"icon",variant:"ghost",onClick:()=>{if(!v)return;let e=v.utterances.map(e=>{let t=S[e.speaker]||"Speaker ".concat(e.speaker);return"".concat(t," ").concat(formatTimestamp(e.start),"\n").concat(e.text,"\n")}).join("\n");navigator.clipboard.writeText(e)},title:"Copy to clipboard",children:(0,a.jsx)(c.Z,{className:"h-4 w-4"})}),(0,a.jsx)(b,{size:"icon",variant:"ghost",onClick:()=>{if(!v)return;let e=v.utterances.map(e=>{let t=S[e.speaker]||"Speaker ".concat(e.speaker);return"".concat(t," ").concat(formatTimestamp(e.start),"\n").concat(e.text,"\n")}).join("\n"),t=new Blob([e],{type:"text/plain"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="transcription.txt",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)},title:"Download as text file",children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(A,{children:(0,a.jsx)(P,{className:"h-[600px] pr-4",children:(0,a.jsx)("div",{className:"space-y-4",children:v.utterances.map((e,t)=>(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"font-medium",children:S[e.speaker]||"Speaker ".concat(e.speaker)}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground ml-4",children:[" ",formatTimestamp(e.start)]})]}),(0,a.jsx)("p",{className:"pl-4 text-muted-foreground",children:e.text})]},t))})})})]})]}),(0,a.jsx)("audio",{ref:Z,className:"hidden"})]})}}}]);