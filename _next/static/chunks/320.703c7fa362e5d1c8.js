"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[320],{7320:function(e,r,t){t.r(r),t.d(r,{default:function(){return components_TranscriptionApp}});var a=t(7437),s=t(2265),n=t(1541),l=t(6264),i=t(3101),o=t(4900),c=t(6224),d=t(5817),u=t(6061),p=t(7042),m=t(3986);function cn(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,m.m)((0,p.W)(r))}let f=(0,u.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),h=s.forwardRef((e,r)=>{let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{ref:r,role:"alert",className:cn(f({variant:s}),t),...n})});h.displayName="Alert";let x=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h5",{ref:r,className:cn("mb-1 font-medium leading-none tracking-tight",t),...s})});x.displayName="AlertTitle";let v=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:cn("text-sm [&_p]:leading-relaxed",t),...s})});v.displayName="AlertDescription";var g=t(4972);let y=(0,u.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),b=s.forwardRef((e,r)=>{let{className:t,variant:s,size:n,asChild:l=!1,...i}=e,o=l?g.g7:"button";return(0,a.jsx)(o,{className:cn(y({variant:s,size:n,className:t})),ref:r,...i})});b.displayName="Button";let j=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:cn("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});j.displayName="Card";let N=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:cn("flex flex-col space-y-1.5 p-6",t),...s})});N.displayName="CardHeader";let w=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:cn("text-2xl font-semibold leading-none tracking-tight",t),...s})});w.displayName="CardTitle";let k=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:cn("text-sm text-muted-foreground",t),...s})});k.displayName="CardDescription";let C=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:cn("p-6 pt-0",t),...s})});C.displayName="CardContent";let A=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:cn("flex items-center p-6 pt-0",t),...s})});A.displayName="CardFooter";let S=s.forwardRef((e,r)=>{let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:cn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n})});S.displayName="Input";var T=t(3607);let R=s.forwardRef((e,r)=>{let{className:t,orientation:s="horizontal",decorative:n=!0,...l}=e;return(0,a.jsx)(T.f,{ref:r,decorative:n,orientation:s,className:cn("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",t),...l})});R.displayName=T.f.displayName;var E=t(485);let _=s.forwardRef((e,r)=>{let{className:t,children:s,...n}=e;return(0,a.jsxs)(E.fC,{ref:r,className:cn("relative overflow-hidden",t),...n,children:[(0,a.jsx)(E.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,a.jsx)(P,{}),(0,a.jsx)(E.Ns,{})]})});_.displayName=E.fC.displayName;let P=s.forwardRef((e,r)=>{let{className:t,orientation:s="vertical",...n}=e;return(0,a.jsx)(E.gb,{ref:r,orientation:s,className:cn("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:(0,a.jsx)(E.q4,{className:"relative flex-1 rounded-full bg-border"})})});P.displayName=E.gb.displayName;var components_TranscriptionApp=()=>{let[e,r]=(0,s.useState)(()=>localStorage.getItem("assemblyai_key")||""),[t,u]=(0,s.useState)(null),[p,m]=(0,s.useState)(!1),[f,x]=(0,s.useState)(null),[g,y]=(0,s.useState)(null),[A,T]=(0,s.useState)({}),[E,P]=(0,s.useState)({}),[I,z]=(0,s.useState)(!1),[U,L]=(0,s.useState)(null),O=(0,s.useRef)(null),Z=(0,s.useRef)(null),F=(0,s.useRef)(null);(0,s.useEffect)(()=>(Z.current=new Audio,()=>{Z.current&&(Z.current.pause(),Z.current.src="")}),[]);let uploadToAssemblyAI=async r=>{if(!e)throw Error("Please enter your AssemblyAI API key");try{let t=await fetch("https://api.assemblyai.com/v2/upload",{method:"POST",headers:{Authorization:e},body:r});if(!t.ok)throw Error("Failed to upload audio file");let a=await t.json(),s=a.upload_url,n=await fetch("https://api.assemblyai.com/v2/transcript",{method:"POST",headers:{Authorization:e,"Content-Type":"application/json"},body:JSON.stringify({audio_url:s,speaker_labels:!0})});if(!n.ok)throw Error("Failed to initiate transcription");let l=await n.json(),i=await pollTranscriptionStatus(l.id);return i}catch(e){throw Error("Transcription failed: ".concat(e instanceof Error?e.message:"Unknown error"))}},pollTranscriptionStatus=async r=>{if(!e)throw Error("Please enter your AssemblyAI API key");let t=0;for(;t<120;){let a=await fetch("https://api.assemblyai.com/v2/transcript/".concat(r),{headers:{Authorization:e}}),s=await a.json();if("completed"===s.status)return s;if("error"===s.status)throw Error("Transcription failed");t++,await new Promise(e=>setTimeout(e,1e3))}throw Error("Transcription timed out")},findSpeakerExcerpts=e=>{let r={};e.forEach(e=>{r[e.speaker]||(r[e.speaker]=[]),r[e.speaker].push(e)});let t={};return Object.keys(r).forEach(e=>{let a=r[e],s=[...a].sort((e,r)=>r.end-r.start-(e.end-e.start));t[e]=s.slice(0,3)}),t},handleSubmit=async()=>{if(t){m(!0),x(null);try{let e=await uploadToAssemblyAI(t);y(e);let r=Array.from(new Set(e.utterances.map(e=>e.speaker))),a={};r.forEach(e=>{a[e]=""}),T(a);let s=findSpeakerExcerpts(e.utterances);P(s)}catch(e){x(e instanceof Error?e.message:"Error processing the audio file"),console.error(e)}finally{m(!1)}}},handleSpeakerNameChange=(e,r)=>{T(t=>({...t,[e]:r}))},formatTimestamp=e=>{let r=Math.floor(e/1e3),pad=e=>e.toString().padStart(2,"0");return"".concat(pad(Math.floor(r/3600)),":").concat(pad(Math.floor(r%3600/60)),":").concat(pad(r%60))},stopCurrentPlayback=()=>{Z.current&&(Z.current.pause(),F.current&&(Z.current.removeEventListener("timeupdate",F.current),F.current=null),Z.current.src=""),z(!1),L(null)},playAudioExcerpt=async(e,r)=>{if(t&&Z.current)try{if(stopCurrentPlayback(),U==="".concat(e,"-").concat(r))return;let a=new Blob([t],{type:t.type}),s=URL.createObjectURL(a);Z.current.src=s,Z.current.currentTime=e/1e3;let handleTimeUpdate=()=>{Z.current&&Z.current.currentTime>=r/1e3&&(stopCurrentPlayback(),URL.revokeObjectURL(s))};F.current=handleTimeUpdate,Z.current.addEventListener("timeupdate",handleTimeUpdate),await Z.current.play(),z(!0),L("".concat(e,"-").concat(r))}catch(e){console.error("Audio playback error:",e),stopCurrentPlayback()}};return(0,a.jsxs)("div",{className:"container max-w-4xl mx-auto p-4 space-y-8",children:[(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:"VoiceScribe AI"}),(0,a.jsx)("p",{className:"text-muted-foreground text-lg",children:"Transform your conversations into text with speaker recognition"})]}),!e&&(0,a.jsxs)(j,{children:[(0,a.jsxs)(N,{children:[(0,a.jsx)(w,{children:"API Key Required"}),(0,a.jsxs)(k,{children:["Get your free API key from"," ",(0,a.jsx)("a",{href:"https://www.assemblyai.com/",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"AssemblyAI"})]})]}),(0,a.jsx)(C,{children:(0,a.jsx)(S,{type:"text",placeholder:"Enter your AssemblyAI API key",value:e,onChange:e=>{r(e.target.value),localStorage.setItem("assemblyai_key",e.target.value)}})})]}),(0,a.jsx)(j,{children:(0,a.jsxs)(C,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-10 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)(n.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Click to upload or drag and drop audio file"}),t&&(0,a.jsxs)("p",{className:"mt-2 text-sm text-muted-foreground",children:["Current file: ",t.name]})]}),t&&(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsx)(b,{onClick:handleSubmit,disabled:p,children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Transcribe"})}),(0,a.jsx)("input",{ref:O,type:"file",onChange:e=>{var r;let t=e.target,a=null===(r=t.files)||void 0===r?void 0:r[0];t.value="",a&&a.type.startsWith("audio/")?(Z.current&&(Z.current.pause(),Z.current.src=""),z(!1),L(null),u(a),x(null),y(null),T({}),P({})):a&&(x("Please upload a valid audio file"),u(null))},accept:"audio/*",className:"hidden"})]})}),f&&(0,a.jsx)(h,{variant:"destructive",children:(0,a.jsx)(v,{children:f})}),g&&(0,a.jsxs)("div",{className:"grid gap-8 md:grid-cols-2",children:[(0,a.jsxs)(j,{children:[(0,a.jsxs)(N,{children:[(0,a.jsx)(w,{children:"Speakers"}),(0,a.jsx)(k,{children:"Customize speaker names and listen to excerpts"})]}),(0,a.jsx)(C,{className:"space-y-6",children:Object.keys(A).map(e=>{var r;return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(S,{value:A[e],onChange:r=>handleSpeakerNameChange(e,r.target.value),placeholder:"Enter name for Speaker ".concat(e)}),(0,a.jsx)("div",{className:"space-y-3 pl-4",children:null===(r=E[e])||void 0===r?void 0:r.map((e,r)=>(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(b,{size:"icon",variant:"ghost",onClick:()=>playAudioExcerpt(e.start,e.end),className:"h-8 w-8",children:U==="".concat(e.start,"-").concat(e.end)&&I?(0,a.jsx)(i.Z,{className:"h-4 w-4"}):(0,a.jsx)(o.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:formatTimestamp(e.start)}),(0,a.jsx)("p",{className:"text-sm line-clamp-2",children:e.text})]})]},r))}),(0,a.jsx)(R,{className:"my-4"})]},e)})})]}),(0,a.jsxs)(j,{className:"h-fit",children:[(0,a.jsxs)(N,{className:"flex-row items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w,{children:"Transcription"}),(0,a.jsx)(k,{children:"Complete conversation transcript"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(b,{size:"icon",variant:"ghost",onClick:()=>{if(!g)return;let e=g.utterances.map(e=>{let r=A[e.speaker]||"Speaker ".concat(e.speaker);return"".concat(r," ").concat(formatTimestamp(e.start),"\n").concat(e.text,"\n")}).join("\n");navigator.clipboard.writeText(e)},title:"Copy to clipboard",children:(0,a.jsx)(c.Z,{className:"h-4 w-4"})}),(0,a.jsx)(b,{size:"icon",variant:"ghost",onClick:()=>{if(!g)return;let e=g.utterances.map(e=>{let r=A[e.speaker]||"Speaker ".concat(e.speaker);return"".concat(r," ").concat(formatTimestamp(e.start),"\n").concat(e.text,"\n")}).join("\n"),r=new Blob([e],{type:"text/plain"}),t=URL.createObjectURL(r),a=document.createElement("a");a.href=t,a.download="transcription.txt",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},title:"Download as text file",children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(C,{children:(0,a.jsx)(_,{className:"h-[600px] pr-4",children:(0,a.jsx)("div",{className:"space-y-4",children:g.utterances.map((e,r)=>(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:A[e.speaker]||"Speaker ".concat(e.speaker)}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:formatTimestamp(e.start)})]}),(0,a.jsx)("p",{className:"pl-4 text-muted-foreground",children:e.text})]},r))})})})]})]}),(0,a.jsx)("audio",{ref:Z,className:"hidden"})]})}}}]);